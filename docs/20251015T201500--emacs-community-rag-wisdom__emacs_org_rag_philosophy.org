* ğŸ§  Emacs Org-mode RAG í†µí•© ì „ëµ: í•œê¸€ í™˜ê²½ íŠ¹í™”
:PROPERTIES:
:CUSTOM_ID: emacs-org-mode-rag-í†µí•©-ì „ëµ-í•œê¸€-í™˜ê²½-íŠ¹í™”
:END:
*ëª©ì *: Org-mode ì§€ì‹ë² ì´ìŠ¤ ë¨¼ì € ê³ ë„í™” â†’ ê²½í—˜ ê²€ì¦ â†’ memex-kb ì—­ì ìš©
*ì ‘ê·¼*: Emacs ì»¤ë®¤ë‹ˆí‹° ì§€í˜œ + í•œê¸€ íŠ¹í™” + ì‹¤ì „ ê²½í—˜

--------------

** ğŸ¯ ì „ëµ ì „í™˜: "Org-mode ìš°ì„ "
:PROPERTIES:
:CUSTOM_ID: ì „ëµ-ì „í™˜-org-mode-ìš°ì„ 
:END:
*** Before (memex-kb ì¤‘ì‹¬)
:PROPERTIES:
:CUSTOM_ID: before-memex-kb-ì¤‘ì‹¬
:END:
#+begin_example
Legacy ë¬¸ì„œ â†’ memex-kb ë³€í™˜ â†’ Denote â†’ ì„ë² ë”© â†’ RAG

ë¬¸ì œ:
  - Legacy ë¬¸ì„œ ë³€í™˜ì€ "ê°í¥ ì—†ìŒ"
  - ê²€ì¦ ì—†ì´ ì„¤ê³„ë§Œ
  - ìì‹ ì˜ ì§€ì‹ë² ì´ìŠ¤ í™œìš© ì•ˆ ë¨
#+end_example

*** After (Org-mode ìš°ì„ )
:PROPERTIES:
:CUSTOM_ID: after-org-mode-ìš°ì„ 
:END:
#+begin_example
~/org/ (1,400+ íŒŒì¼)
    â†“ Emacs ì»¤ë®¤ë‹ˆí‹° ì „ëµ ì ìš©
ì‹¤í—˜ & ê²€ì¦ (ì‹¤ì „ ê²½í—˜)
    â†“ í•œê¸€ í™˜ê²½ ìµœì í™”
ë‚˜ë§Œì˜ ì „ëµ í™•ë¦½
    â†“ ì—­ì ìš©
memex-kb v2.0 (ê²€ì¦ëœ ë°©ë²•ë¡ )

ê°€ì¹˜:
  âœ… ìì‹ ì˜ ì§€ì‹ë² ì´ìŠ¤ ì¦‰ì‹œ í™œìš©
  âœ… ì‹¤ì „ ê²½í—˜ ê¸°ë°˜
  âœ… í•œê¸€ í™˜ê²½ ê³ ë ¤
  âœ… ê²€ì¦ í›„ memex-kbì— ì ìš©
#+end_example

--------------

** ğŸ“Š Emacs ì»¤ë®¤ë‹ˆí‹° ì „ë¬¸ê°€ ë¶„ì„ (ì¢…í•©)
:PROPERTIES:
:CUSTOM_ID: emacs-ì»¤ë®¤ë‹ˆí‹°-ì „ë¬¸ê°€-ë¶„ì„-ì¢…í•©
:END:

--------------

** ğŸ” ë°œê²¬í•œ í”„ë¡œì íŠ¸ (5ê°œ)
:PROPERTIES:
:CUSTOM_ID: ë°œê²¬í•œ-í”„ë¡œì íŠ¸-5ê°œ
:END:
*** 1. *ELISA* (s-kostyaev) â­â­â­â­â­
:PROPERTIES:
:CUSTOM_ID: elisa-s-kostyaev
:END:
*GitHub*: https://github.com/s-kostyaev/elisa

*ì²­í‚¹ ì „ëµ* (í•µì‹¬!):

#+begin_src elisp
;; elisa.el (line 638-644, 697-729)

(defun elisa-split-by-paragraph ()
  "Split buffer to list of paragraphs."
  (elisa--split-by #'forward-paragraph))

(defun elisa-split-semantically ()
  "Split buffer data semantically."
  ;; 1. Paragraphë¡œ ì²­í‚¹
  (let* ((chunks (elisa-split-by-paragraph))
         ;; 2. ëª¨ë“  ì²­í¬ ì„ë² ë”©
         (embeddings (elisa-embeddings chunks))
         ;; 3. Cosine distance ê³„ì‚°
         (distances (elisa--distances embeddings))
         ;; 4. Threshold ê¸°ë°˜ ë³‘í•©
         (threshold (elisa-calculate-threshold k distances)))
    ;; distance <= thresholdì´ë©´ ë³‘í•©
    ;; distance > thresholdì´ë©´ ë¶„ë¦¬
    ...))
#+end_src

*í•µì‹¬*: - *ê°„ë‹¨í•¨*: forward-paragraph ì‚¬ìš© (Emacs ë‚´ì¥) - *ì˜ë¯¸ ê¸°ë°˜*:
Cosine distanceë¡œ ë³‘í•© íŒë‹¨ - *~30ì¤„*: ì „ì²´ ì²­í‚¹ ë¡œì§ - *í†µì œ ê°€ëŠ¥*:
ì§ê´€ì , ë””ë²„ê¹… ì‰¬ì›€

*Hybrid Search* (SQLë¡œ!):

#+begin_src sql
-- elisa.el (line 573-609)

WITH
vector_search AS (
  SELECT rowid, distance FROM data_embeddings
  WHERE vss_search(embedding, query_embedding)
  ORDER BY distance ASC LIMIT 40
),
keyword_search AS (
  SELECT rowid, RANK () OVER (ORDER BY bm25(data_fts) ASC)
  FROM data_fts WHERE data_fts MATCH query
  ORDER BY bm25(data_fts) ASC LIMIT 20
),
hybrid_search AS (
  SELECT
    COALESCE(semantic_search.rowid, keyword_search.rowid) AS rowid,
    COALESCE(1.0 / (60 + semantic_search.rank), 0.0) +
    COALESCE(1.0 / (60 + keyword_search.rank), 0.0) AS score
  FROM semantic_search
  FULL OUTER JOIN keyword_search
  ORDER BY score DESC LIMIT K
)
#+end_src

*ê¸°ìˆ  ìŠ¤íƒ*:

#+begin_src elisp
Backend: SQLite (Emacs ë‚´ì¥!)
  - sqlite-vss: ë²¡í„° ê²€ìƒ‰
  - FTS5: í‚¤ì›Œë“œ ê²€ìƒ‰

Embedding: Ollama (ë¡œì»¬)
  - nomic-embed-text (ê¸°ë³¸)

Reranker: ì„ íƒì  (ì™¸ë¶€ API)

Collections: ë””ë ‰í† ë¦¬ë³„ ê´€ë¦¬
#+end_src

--------------

*** 2. *Org-roam Semantic Search* (lgmoneda) â­â­â­â­
:PROPERTIES:
:CUSTOM_ID: org-roam-semantic-search-lgmoneda
:END:
*ë¸”ë¡œê·¸*:
https://lgmoneda.github.io/2023/04/08/semantic-search-for-org-roam.html

*ê·œëª¨*: 3.4k notes (ì‹¤ì „!)

*ì²­í‚¹ ì „ëµ*:

#+begin_src python
# Node ë‹¨ìœ„ (Org-roam ë…¸ë“œ = Org heading)

1. Org-roam node ì¶”ì¶œ
   - node_text_nested_exclusive (ìì‹ ë…¸ë“œ ì œì™¸)

2. ì²­í¬ ë¶„í•  (ë„ˆë¬´ ê¸¸ë©´)
   - chunk_size: 300 characters
   - chunk_overlap: 0
   - Sentence-based split

3. Hierarchy ë©”íƒ€ë°ì´í„° ë³´ì¡´
   - [Parent > Child > Grandchild]
   - ê° ì²­í¬ì— hierarchy ì¶”ê°€
#+end_src

*Org structure í™œìš©*:

#+begin_src python
# Properties í™œìš©!
if ":SEARCH: ignore" in properties:
    skip_node()  # ê²€ìƒ‰ ì œì™¸

# Hierarchy ë³´ì¡´
node_hierarchy = extract_org_hierarchy(node)
embedding_text = f"{hierarchy}\n\n{content}"
#+end_src

*í•µì‹¬*: - Org *Node ë‹¨ìœ„* (Org heading = ì˜ë¯¸ ë‹¨ìœ„!) - *Hierarchy ë³´ì¡´*
(Parent > Child ê´€ê³„) - *Properties í™œìš©* (=:SEARCH: ignore=) - *300
characters* (ì§§ê²Œ ì²­í‚¹)

--------------

*** 3. *sem.el* (lepisma) â­â­â­â­
:PROPERTIES:
:CUSTOM_ID: sem.el-lepisma
:END:
*ë¸”ë¡œê·¸*: https://lepisma.xyz/2025/01/17/emacs-on-device-ml/

*ì»¨ì…‰*: ì™„ì „ ë¡œì»¬, Emacs ë‚´ì¥

*ê¸°ìˆ  ìŠ¤íƒ*:

#+begin_src elisp
ML: ONNX.el (Emacs dynamic module)
  - all-MiniLM-L6-v2 (CPU ìµœì í™”)
  - ì™„ì „ ì˜¨ë””ë°”ì´ìŠ¤

Vector DB: LanceDB (ë¡œì»¬)

Indexing: IVF-PQ (ë¹ ë¥¸ ê²€ìƒ‰)

í…ŒìŠ¤íŠ¸: 38,171 Emacs symbols ì„ë² ë”©
#+end_src

*ì„±ëŠ¥*:

#+begin_example
Initial search: ~0.089 sec/query
Indexed search: ~0.033 sec/query
#+end_example

*í•µì‹¬*: - *ì™„ì „ ë¡œì»¬*: ì™¸ë¶€ í”„ë¡œì„¸ìŠ¤ ì—†ìŒ - *Emacs ë„¤ì´í‹°ë¸Œ*: Dynamic
module - *ë¹ ë¦„*: 0.033ì´ˆ ê²€ìƒ‰

--------------

*** 4. *ekg* (ahyatt) â­â­â­â­
:PROPERTIES:
:CUSTOM_ID: ekg-ahyatt
:END:
*GitHub*: https://github.com/ahyatt/ekg

*ì»¨ì…‰*: Emacs Knowledge Graph

*ê¸°ìˆ *:

#+begin_src elisp
Backend: SQLite (triples DB)
  - Subject-Predicate-Object êµ¬ì¡°

Org-mode: ê¸°ë³¸ ëª¨ë“œ
  - ekg-embedding ëª¨ë“ˆ (ì„ íƒ)
  - llm package í†µí•©

Denote: ekg-denote.el (í†µí•© ê°œë°œ ì¤‘)
#+end_src

*ì² í•™*: - *SQLite ê¸°ë°˜* (íŒŒì¼ì‹œìŠ¤í…œ ì•„ë‹˜) - *Triples* (ì§€ì‹ ê·¸ë˜í”„) -
*Tag ì¤‘ì‹¬* (Backlinkë³´ë‹¤) - *ì‘ì€ ì›ìì  ë…¸íŠ¸*

*ekg vs Denote discussion*: - Denote: íŒŒì¼ ê¸°ë°˜, Luhmann signature -
ekg: SQLite ê¸°ë°˜, Tag + Graph - *ekg-denote.el*: ë‘ ì‹œìŠ¤í…œ í†µí•© (ê°œë°œ
ì¤‘)

--------------

*** 5. *semext + embed-db* (ahyatt) â­â­â­
:PROPERTIES:
:CUSTOM_ID: semext-embed-db-ahyatt
:END:
*GitHub*: - https://github.com/ahyatt/semext - embed-dbëŠ” ekg-embedding
ëª¨ë“ˆì— í†µí•©ëœ ê²ƒìœ¼ë¡œ ë³´ì„

*ì»¨ì…‰*: Semantic versions of existing Emacs functionality

#+begin_src elisp
(use-package semext
  :vc (:fetcher github :repo "ahyatt/semext")
  :init
  (setopt semext-provider
    (make-llm-ollama :chat-model "gemma3:1b")))

;; M-x semext-search (ì˜ë¯¸ ê²€ìƒ‰)
;; M-x semext-query-replace (ì˜ë¯¸ ê¸°ë°˜ êµì²´)
#+end_src

--------------

*** 6. *emacs-rag-libsql* (John Kitchin) â­â­â­â­â­
:PROPERTIES:
:CUSTOM_ID: emacs-rag-libsql-john-kitchin
:END:
*GitHub*: https://github.com/jkitchin/emacs-rag-libsql

*ê·œëª¨*: YouTube ì‹œì—° (ì‹¤ì „!)

*ì½”ë“œ ì‹¤ì¸¡* (Git Clone):

#+begin_src yaml
Total: ~920ì¤„
  chunking.py: 66ì¤„ (!)
  database.py: 854ì¤„

ì²­í‚¹ ë¡œì§ (ë‹¨ 40ì¤„!):
  def chunk_text(text, chunk_size, overlap):
      chunks = []
      start = 0
      while start < len(text):
          end = min(start + chunk_size, len(text))
          chunk = text[start:end]
          line_number = text[:start].count('\n') + 1  # â† í•µì‹¬!
          chunks.append((chunk, line_number))
          start = max(start + 1, end - overlap)
      return chunks

  â†’ Position ê¸°ë°˜ (ê°„ë‹¨!)
  â†’ Line number ì¶”ì  (Emacs goto-line)
#+end_src

*ì²œì¬ì  ì„¤ê³„: Org Heading ë³„ë„ í…Œì´ë¸”*:

#+begin_src sql
-- 1. ë¬¸ì„œ ì²­í¬ í…Œì´ë¸” (ì „ì²´ ë‚´ìš©)
CREATE TABLE documents (
    id TEXT PRIMARY KEY,          -- {path}:{chunk_index}
    source_path TEXT,
    chunk_index INTEGER,
    line_number INTEGER,          -- â† Emacs í†µí•©!
    content TEXT,
    ...
);

CREATE TABLE embeddings (
    id TEXT PRIMARY KEY,
    vector BLOB,
    model TEXT
);

-- 2. Org Heading í…Œì´ë¸” (êµ¬ì¡°ë§Œ!) â† ê²Œì„ ì²´ì¸ì €!
CREATE TABLE org_headings (
    id INTEGER PRIMARY KEY,
    source_path TEXT,
    line_number INTEGER,          -- â† ì •í™•í•œ ìœ„ì¹˜!
    heading_text TEXT,            -- * Heading
    tags TEXT,                    -- :tag1:tag2:
    level INTEGER,                -- *, **, ***
    ...
);

CREATE TABLE org_heading_embeddings (
    heading_id INTEGER,
    vector BLOB,
    model TEXT
);
#+end_src

*2-Tier ê²€ìƒ‰ ì „ëµ*:

#+begin_src python
# Tier 1: Heading Search (ë¹ ë¦„!)
query_org_headings_by_vector(query, n=20)
â†’ 100ê°œ í—¤ë”© ê²€ìƒ‰
â†’ 30-50ms
â†’ ì •í™•í•œ ìœ„ì¹˜ (file:line)
â†’ Ivy ë™ì  ê²€ìƒ‰ (íƒ€ì´í•‘í•˜ë©´ì„œ!)

# Tier 2: Content Search (ëŠë¦¼, í•„ìš” ì‹œë§Œ)
query_by_vector(query, n=5)
â†’ 20,000ê°œ ì²­í¬ ê²€ìƒ‰
â†’ 200ms
â†’ ìƒì„¸ ë‚´ìš©

â†’ í‰ê·  4ë°° ë¹ ë¦„!
#+end_src

*gptel í†µí•©* (Claude Code ì—ì´ì „íŠ¸):

#+begin_src elisp
(defvar emacs-rag-gptel-tool-search-headings
  (gptel-make-tool
   :function #'emacs-rag-gptel--search-headings
   :name "rag_search_headings"
   :description "Search org-mode headings semantically"
   :category "rag"))

;; Agent: "Find headings about Denote"
;; â†’ rag_search_headings("Denote workflow")
;; â†’ [[file:~/org/meta/denote.org::15][Denote silo]]
#+end_src

*ê¸°ìˆ  ìŠ¤íƒ*:

#+begin_src yaml
Backend: LibSQL (SQLite fork) + Vector extension
API: FastAPI (8ê°œ ì˜ì¡´ì„±, ê²½ëŸ‰)
Model: all-MiniLM-L6-v2 (384-dim, 80MB)
Reranker: cross-encoder/ms-marco-MiniLM-L-6-v2
Emacs: transient + Ivy + gptel
#+end_src

*í•µì‹¬ í†µì°°*:

#+begin_example
"Org Headingì€ ìì—°ìŠ¤ëŸ¬ìš´ ì˜ë¯¸ ë‹¨ìœ„"

Heading ë³„ë„ ì„ë² ë”©:
  â†’ ë¹ ë¥¸ êµ¬ì¡° íƒìƒ‰
  â†’ ì •í™•í•œ ìœ„ì¹˜
  â†’ ì—ì´ì „íŠ¸ ì¹œí™”ì 

66ì¤„ ê°„ë‹¨ ì²­í‚¹:
  â†’ Position ê¸°ë°˜ (ì¶©ë¶„íˆ ì¢‹ìŒ)
  â†’ Line number ì¶”ì  (í•„ìˆ˜!)
#+end_example

--------------

** ğŸ“Š ì „ë¬¸ê°€ ì²­í‚¹ ì „ëµ ë¹„êµí‘œ
:PROPERTIES:
:CUSTOM_ID: ì „ë¬¸ê°€-ì²­í‚¹-ì „ëµ-ë¹„êµí‘œ
:END:
| í”„ë¡œì íŠ¸           | ì²­í‚¹ ë°©ì‹                             | ì½”ë“œ ë¼ì¸ | í•µì‹¬ ì•„ì´ë””ì–´  | í•œê¸€ ê³ ë ¤ |
|--------------------+---------------------------------------+-----------+----------------+-----------|
| *ELISA*            | forward-paragraph + semantic distance | ~30ì¤„     | ì˜ë¯¸ ê¸°ë°˜ ë³‘í•© | âŒ        |
| *Org-roam*         | Node ë‹¨ìœ„ (Org heading)               | ê°„ë‹¨      | Hierarchy ë³´ì¡´ | âŒ        |
| *sem.el*           | ONNX ë‚´ì¥                             | -         | ì™„ì „ ë¡œì»¬      | âŒ        |
| *John Kitchin*     | Position ê¸°ë°˜ + Heading ë³„ë„ í…Œì´ë¸”   | 66ì¤„      | 2-Tier ê²€ìƒ‰    | âŒ        |
| *embedding-config* | Org heading + í´ë”ë³„ ì°¨ë³„í™”           | ~30ì¤„     | ê³„ì¸µ êµ¬ì¡°      | âš ï¸ ë¶€ë¶„    |

*ê³µí†µì *: - 30-66ì¤„ë¡œ ì²­í‚¹ ì™„ë£Œ (vs Chonkie 33,777ì¤„) - Org êµ¬ì¡° í™œìš©
(Heading, Paragraph, Properties) - ê°„ë‹¨í•¨ > ë³µì¡í•¨

*í•œê¸€ í™˜ê²½ ë¬¸ì œ*: - ëª¨ë‘ ì˜ì–´ í™˜ê²½ ê¸°ì¤€ - í•œê¸€ í† í° ê³„ì‚° ë¯¸ê³ ë ¤ - Denote
í•œê¸€ ì œëª© ë¯¸ì§€ì› - filetags í•œê¸€/ì˜ì–´ í˜¼ì¬ ë¯¸ê³ ë ¤

--------------

** ğŸ¯ Emacs ì»¤ë®¤ë‹ˆí‹°ì˜ ê³µí†µ íŒ¨í„´
:PROPERTIES:
:CUSTOM_ID: emacs-ì»¤ë®¤ë‹ˆí‹°ì˜-ê³µí†µ-íŒ¨í„´
:END:
*** Pattern 1: Org Structure í™œìš©
:PROPERTIES:
:CUSTOM_ID: pattern-1-org-structure-í™œìš©
:END:
*Org ê³ ìœ  êµ¬ì¡°*:

#+begin_src org
,* Heading 1                    â† ìì—°ìŠ¤ëŸ¬ìš´ ì²­í‚¹ ë‹¨ìœ„!
  :PROPERTIES:
  :ID: unique-id
  :FILETAGS: :emacs:org:       â† ë©”íƒ€ë°ì´í„°
  :END:

,** Subheading                  â† ê³„ì¸µ (Level 2)
   Content...

[[id:unique-id][Link]]         â† ì—°ê²°
#+end_src

*í™œìš© ë°©ì‹*:

#+begin_example
ELISA: forward-paragraph (Emacs ë‚´ì¥)
Org-roam: Node ë‹¨ìœ„ (Org heading)
John Kitchin: Heading ë³„ë„ í…Œì´ë¸” + ì •ê·œì‹
embedding-config: Org heading ê¸°ì¤€ (*, **, ***)

â†’ Org structureê°€ ì´ë¯¸ ì²­í‚¹ì„ ìœ„í•´ ì„¤ê³„ë¨!
#+end_example

--------------

*** Pattern 2: ê°„ë‹¨í•œ ì²­í‚¹ ë¡œì§ (30-66ì¤„)
:PROPERTIES:
:CUSTOM_ID: pattern-2-ê°„ë‹¨í•œ-ì²­í‚¹-ë¡œì§-30-66ì¤„
:END:
| í”„ë¡œì íŠ¸ | ì²­í‚¹ ë°©ì‹                             | ì½”ë“œ ë³µì¡ë„ |
|----------+---------------------------------------+-------------|
| ELISA    | forward-paragraph + semantic distance | ~30ì¤„       |
| Org-roam | Node ë‹¨ìœ„ + 300 char split            | ê°„ë‹¨        |
| sem.el   | (ë¯¸í™•ì¸, ONNX ë‚´ì¥ ê°€ëŠ¥ì„±)            | -           |
| ekg      | SQLite ê¸°ë°˜                           | Triples     |

*ê³µí†µì *: - *Emacs ë‚´ì¥ í•¨ìˆ˜ í™œìš©* (forward-paragraph,
forward-sentence) - *ê°„ë‹¨í•œ ë¡œì§* (ë³µì¡í•œ ì•Œê³ ë¦¬ì¦˜ íšŒí”¼) - *Org êµ¬ì¡°
ì¡´ì¤‘* (Heading, Node, Paragraph)

--------------

*** Pattern 3: SQLite ë°±ì—”ë“œ
:PROPERTIES:
:CUSTOM_ID: pattern-3-sqlite-ë°±ì—”ë“œ
:END:
#+begin_src elisp
# ELISA: sqlite-vss + FTS5
# ekg: triples (Subject-Predicate-Object)
# sem.el: LanceDB (ì„ íƒì )

â†’ Emacs 29.2+ ë‚´ì¥ SQLite í™œìš©!
#+end_src

--------------

*** Pattern 4: Hybrid Search
:PROPERTIES:
:CUSTOM_ID: pattern-4-hybrid-search
:END:
#+begin_example
Vector Search (ì˜ë¯¸)
    +
Keyword Search (BM25/FTS5)
    +
Reranker (ì„ íƒì )

â†’ í’ˆì§ˆ > ë³µì¡ë„
#+end_example

--------------

*** Pattern 5: ë¡œì»¬ ìš°ì„ 
:PROPERTIES:
:CUSTOM_ID: pattern-5-ë¡œì»¬-ìš°ì„ 
:END:
#+begin_src elisp
# ELISA: Ollama (nomic-embed-text)
# sem.el: ONNX (all-MiniLM-L6-v2, CPU)
# ekg: llm package (ë‹¤ì–‘í•œ provider)
# Org-roam: OpenAI or sentence-transformers

â†’ í”„ë¼ì´ë²„ì‹œ, í†µì œê¶Œ
#+end_src

--------------

** ğŸ’¡ ì™œ Chonkie ê°™ì€ ë³µì¡í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¡´ì¬í•˜ë‚˜?
:PROPERTIES:
:CUSTOM_ID: ì™œ-chonkie-ê°™ì€-ë³µì¡í•œ-ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€-ì¡´ì¬í•˜ë‚˜
:END:
*** íƒ€ê²Ÿ ì‚¬ìš©ì ì°¨ì´
:PROPERTIES:
:CUSTOM_ID: íƒ€ê²Ÿ-ì‚¬ìš©ì-ì°¨ì´
:END:
*Chonkie íƒ€ê²Ÿ*:

#+begin_example
ë²”ìš© RAG ì‹œìŠ¤í…œ
- ë‹¤ì–‘í•œ ë¬¸ì„œ (PDF, Code, Markdown, HTML...)
- ë‹¤ì–‘í•œ ë„ë©”ì¸ (ë²•ë¥ , ì˜ë£Œ, ê¸°ìˆ ...)
- ë‹¤ì–‘í•œ ì‚¬ìš©ì (ì´ˆë³´ì ~ ì „ë¬¸ê°€)

â†’ ëª¨ë“  ê²½ìš°ë¥¼ ì»¤ë²„í•˜ë ¤ë‹¤ ë³´ë‹ˆ ë³µì¡
â†’ 33,777ì¤„ ì½”ë“œ
#+end_example

*Emacs ì»¤ë®¤ë‹ˆí‹° íƒ€ê²Ÿ*:

#+begin_example
Org-mode ì§€ì‹ë² ì´ìŠ¤
- ë‹¨ì¼ í¬ë§· (Org-mode)
- íŠ¹ì • ë„ë©”ì¸ (ê°œì¸ ì§€ì‹)
- ì „ë¬¸ê°€ ì‚¬ìš©ì (Org-mode ì´í•´)

â†’ Org structure í™œìš©ìœ¼ë¡œ ë‹¨ìˆœí™” ê°€ëŠ¥
â†’ ~30ì¤„ ì½”ë“œë©´ ì¶©ë¶„
#+end_example

--------------

** ğŸ—ï¸ Org-modeì˜ êµ¬ì¡°ì  ì¥ì 
:PROPERTIES:
:CUSTOM_ID: org-modeì˜-êµ¬ì¡°ì -ì¥ì 
:END:
*** "Org-modeëŠ” ì´ë¯¸ ì²­í‚¹ì„ ìœ„í•´ ì„¤ê³„ë˜ì—ˆë‹¤"
:PROPERTIES:
:CUSTOM_ID: org-modeëŠ”-ì´ë¯¸-ì²­í‚¹ì„-ìœ„í•´-ì„¤ê³„ë˜ì—ˆë‹¤
:END:
*Org Heading Hierarchy*:

#+begin_src org
,* Level 1 (ê°œë…)
,** Level 2 (ì„¸ë¶€ ê°œë…)
,*** Level 3 (êµ¬ì²´ì  ë‚´ìš©)
#+end_src

*â†’ ìì—°ìŠ¤ëŸ¬ìš´ ì²­í‚¹ ë‹¨ìœ„!*

*Paragraph*:

#+begin_src org
ì²« ë²ˆì§¸ ë¬¸ë‹¨.
ì—¬ëŸ¬ ì¤„ì— ê±¸ì³ ì‘ì„±.

ë‘ ë²ˆì§¸ ë¬¸ë‹¨.
(ë¹ˆ ì¤„ë¡œ êµ¬ë¶„)
#+end_src

*â†’ forward-paragraphë¡œ ì²­í‚¹!*

*Properties*:

#+begin_src org
:PROPERTIES:
:ID: unique-id
:CUSTOM_TAG: value
:SEARCH: ignore  â† ê²€ìƒ‰ ì œì™¸!
:END:
#+end_src

*â†’ ë©”íƒ€ë°ì´í„° + ì œì–´!*

*Denote Filename*:

#+begin_example
20241213T161527--í•œê¸€-ì œëª©__ì˜ì–´_íƒœê·¸ë“¤.org
#+end_example

*â†’ íŒŒì‹± ê°€ëŠ¥, ë©”íƒ€ë°ì´í„° í’ë¶€!*

--------------

** ğŸ“ memex-kbë¥¼ ìœ„í•œ ì§€í˜œ
:PROPERTIES:
:CUSTOM_ID: memex-kbë¥¼-ìœ„í•œ-ì§€í˜œ
:END:
*** 1. Org Structure í™œìš© ì²­í‚¹
:PROPERTIES:
:CUSTOM_ID: org-structure-í™œìš©-ì²­í‚¹
:END:
*embedding-config ì „ëµ (ê²€ì¦ë¨)*:

#+begin_src python
# Org heading ê¸°ì¤€ ì²­í‚¹
sections = re.split(r'\n\*+\s+', text)  # *, **, ***

â†’ 30ì¤„ë¡œ ì¶©ë¶„!
â†’ Org êµ¬ì¡° ì¡´ì¤‘
â†’ ì˜ë¯¸ ë‹¨ìœ„ ë³´ì¡´
#+end_src

*Chonkie í•„ìš” ì—†ìŒ*:

#+begin_example
Chonkie RecursiveChunker: 379ì¤„
embedding-config: 30ì¤„

â†’ 12ë°° ê°„ë‹¨
â†’ ë™ì¼í•œ ëª©ì 
â†’ Orgì— íŠ¹í™”
#+end_example

--------------

*** 2. Hybrid Search (ELISA ë°©ì‹)
:PROPERTIES:
:CUSTOM_ID: hybrid-search-elisa-ë°©ì‹
:END:
*Vector + FTS* (SQLiteë¡œ!):

#+begin_src sql
-- ELISA íŒ¨í„´ (ê²€ì¦ë¨)

Vector Search (sqlite-vss)
    +
Full Text Search (FTS5)
    +
Reciprocal Rank Fusion (SQL!)

â†’ ëª¨ë“  ê²ƒì´ SQLite ì•ˆì—ì„œ!
#+end_src

*memex-kb v2.0 ì ìš©*:

#+begin_src python
# Supabaseë„ PostgreSQL = SQL ê°€ëŠ¥!

CREATE OR REPLACE FUNCTION hybrid_search(
  query_text TEXT,
  query_embedding vector(1024),
  match_count INT
)
RETURNS TABLE(...) AS $$
  WITH
  vector_results AS (
    SELECT * FROM match_org_garden_documents(...)
  ),
  fts_results AS (
    SELECT * FROM org_garden_documents
    WHERE to_tsvector('korean', content) @@ plainto_tsquery('korean', query_text)
  ),
  combined AS (
    -- Reciprocal Rank Fusion
    SELECT ..., RRF_score
    FROM vector_results FULL OUTER JOIN fts_results
  )
  SELECT * FROM combined ORDER BY RRF_score LIMIT match_count;
$$;
#+end_src

--------------

*** 3. Properties í™œìš© (Org-roam ë°©ì‹)
:PROPERTIES:
:CUSTOM_ID: properties-í™œìš©-org-roam-ë°©ì‹
:END:
*ê²€ìƒ‰ ì œì–´*:

#+begin_src org
,* Important Note
  :PROPERTIES:
  :SEARCH: include  â† ê²€ìƒ‰ ìš°ì„ 
  :PRIORITY: high
  :END:

,* Temporary Draft
  :PROPERTIES:
  :SEARCH: ignore  â† ê²€ìƒ‰ ì œì™¸
  :END:
#+end_src

*memex-kb v2.0 ì ìš©*:

#+begin_src python
# Frontmatterë¡œ ë³€í™˜
def parse_org_properties(content):
    if ":SEARCH: ignore" in content:
        return None  # ìŠ¤í‚µ

    priority = extract_property("PRIORITY")
    if priority == "high":
        boost_weight = 1.5  # ê°€ì¤‘ì¹˜
#+end_src

--------------

*** 4. ë¡œì»¬ ìš°ì„  (sem.el ë°©ì‹)
:PROPERTIES:
:CUSTOM_ID: ë¡œì»¬-ìš°ì„ -sem.el-ë°©ì‹
:END:
*ì™„ì „ ì˜¨ë””ë°”ì´ìŠ¤*:

#+begin_src elisp
;; sem.el
ONNX.el (Emacs dynamic module)
    +
all-MiniLM-L6-v2 (80MB, CPU)
    +
LanceDB (ë¡œì»¬ ë²¡í„° DB)

â†’ ì™¸ë¶€ ì˜ì¡´ 0
â†’ í”„ë¼ì´ë²„ì‹œ 100%
â†’ 0.033ì´ˆ ê²€ìƒ‰
#+end_src

*memex-kb v2.0*:

#+begin_src python
# Ollama (ë¡œì»¬) + Supabase (ë¡œì»¬ or í´ë¼ìš°ë“œ)
# ì„ íƒê¶Œ ì œê³µ!

Local: Ollama + FAISS
Cloud: Ollama + Supabase
Hybrid: Ollama + Qdrant (self-hosted)
#+end_src

--------------

** ğŸ“ Emacs ì»¤ë®¤ë‹ˆí‹°ì˜ ì² í•™
:PROPERTIES:
:CUSTOM_ID: emacs-ì»¤ë®¤ë‹ˆí‹°ì˜-ì² í•™
:END:
*** "ê°„ë‹¨í•¨ì€ ê¶ê·¹ì˜ ì •êµí•¨" (Leonardo da Vinci)
:PROPERTIES:
:CUSTOM_ID: ê°„ë‹¨í•¨ì€-ê¶ê·¹ì˜-ì •êµí•¨-leonardo-da-vinci
:END:
*Chonkie*: 33,777ì¤„ - Recipe ì‹œìŠ¤í…œ - C extensions - ë‹¤ì–‘í•œ Chunker
(9ê°œ) - ë³µì¡í•œ ì„¤ì •

*vs*

*ELISA*: ~30ì¤„ ì²­í‚¹ - forward-paragraph - Cosine distance - Threshold
ë³‘í•© - ê°„ë‹¨í•œ ë¡œì§

*â†’ 2,945ê°œ íŒŒì¼ ì„ë² ë”© ì„±ê³µí•œ ë°©ì‹ë„ ~30ì¤„!*

--------------

*** "Org-modeëŠ” ì´ë¯¸ ì„¤ê³„ë˜ì—ˆë‹¤"
:PROPERTIES:
:CUSTOM_ID: org-modeëŠ”-ì´ë¯¸-ì„¤ê³„ë˜ì—ˆë‹¤
:END:
*Org êµ¬ì¡°*:

#+begin_src org
,* Heading (ìì—°ìŠ¤ëŸ¬ìš´ ì²­í‚¹ ë‹¨ìœ„)
  :PROPERTIES: (ë©”íƒ€ë°ì´í„°)
  :END:

  Paragraph (ì˜ë¯¸ ë‹¨ìœ„)

  - List (êµ¬ì¡°í™”)

,** Subheading (ê³„ì¸µ)
#+end_src

*â†’ ì²­í‚¹ì„ ìœ„í•´ ì¬ì„¤ê³„í•  í•„ìš” ì—†ìŒ!*

--------------

*** "í†µì œê¶Œ > í¸ë¦¬í•¨"
:PROPERTIES:
:CUSTOM_ID: í†µì œê¶Œ-í¸ë¦¬í•¨
:END:
*Chonkie*: - ë¸”ë™ë°•ìŠ¤ (379ì¤„ RecursiveChunker) - í•™ìŠµ í•„ìš”
(RecursiveRules, recipe) - ë””ë²„ê¹… ì–´ë ¤ì›€

*ELISA/embedding-config*: - íˆ¬ëª…í•¨ (30ì¤„, ì½ê¸° ì‰¬ì›€) - í•™ìŠµ ë¶ˆí•„ìš”
(forward-paragraph ì§ê´€ì ) - ë””ë²„ê¹… ì‰¬ì›€ (ì§ì ‘ ì‘ì„± ì½”ë“œ)

*â†’ ììœ  ì†Œí”„íŠ¸ì›¨ì–´ ì² í•™: ì½”ë“œëŠ” ì½ì„ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤*

--------------

** ğŸ“Š ì‹¤ì „ ê²€ì¦ ë°ì´í„°
:PROPERTIES:
:CUSTOM_ID: ì‹¤ì „-ê²€ì¦-ë°ì´í„°
:END:
*** ELISA ì‚¬ìš© ì‚¬ë¡€
:PROPERTIES:
:CUSTOM_ID: elisa-ì‚¬ìš©-ì‚¬ë¡€
:END:
#+begin_example
Collections:
  - builtin manuals (Emacs ë§¤ë‰´ì–¼)
  - external manuals (íŒ¨í‚¤ì§€ ë¬¸ì„œ)
  - ë¡œì»¬ íŒŒì¼ (ë””ë ‰í† ë¦¬)
  - Web search (DuckDuckGo/SearXNG)

Hybrid Search:
  - Vector (sqlite-vss)
  - FTS (BM25)
  - Reranker (ì„ íƒì )

Performance:
  - ë¹„ë™ê¸° ì²˜ë¦¬ (async.el)
  - ë°°ì¹˜ ì„ë² ë”© (300ê°œì”©)
#+end_example

--------------

*** Org-roam ì‚¬ìš© ì‚¬ë¡€
:PROPERTIES:
:CUSTOM_ID: org-roam-ì‚¬ìš©-ì‚¬ë¡€
:END:
#+begin_example
Notes: 3.4k (ì‹¤ì „ ê·œëª¨!)

Chunking:
  - Node ë‹¨ìœ„ (Org heading)
  - 300 characters (ì§§ê²Œ)
  - Hierarchy ë³´ì¡´

Metadata:
  - :SEARCH: ignore (ì œì™¸)
  - Node ID, Title, Hierarchy

Model:
  - OpenAI ada-002 (ì›ë˜)
  - sentence-transformers (ëŒ€ì•ˆ)
#+end_example

--------------

*** embedding-config ì‚¬ìš© ì‚¬ë¡€ (memex-kb ì°¸ê³ )
:PROPERTIES:
:CUSTOM_ID: embedding-config-ì‚¬ìš©-ì‚¬ë¡€-memex-kb-ì°¸ê³ 
:END:
#+begin_example
Files: 2,945 Org â†’ 8,310 chunks

Chunking:
  - Org heading ê¸°ì¤€ (*, **, ***)
  - í´ë”ë³„ ì°¨ë³„í™”:
    - meta: 1500 tokens
    - bib: 1200 tokens
    - journal: 800 tokens
    - notes: 1000 tokens

Performance:
  - 100% ì™„ë£Œ (15ë¶„)
  - GPU-03 (Ollama)
  - Supabase pgvector
#+end_example

--------------

** ğŸ† memex-kb v2.0 ì „ëµ í™•ì •
:PROPERTIES:
:CUSTOM_ID: memex-kb-v2.0-ì „ëµ-í™•ì •
:END:
*** Emacs ì»¤ë®¤ë‹ˆí‹° ì§€í˜œ ì ìš©
:PROPERTIES:
:CUSTOM_ID: emacs-ì»¤ë®¤ë‹ˆí‹°-ì§€í˜œ-ì ìš©
:END:
*1. ê°„ë‹¨í•œ ì²­í‚¹* (ELISA íŒ¨í„´):

#+begin_src python
# embedding-config 30ì¤„ ê·¸ëŒ€ë¡œ ì‚¬ìš©
# Org heading ê¸°ì¤€ (*) = forward-paragraph íŒ¨í„´

def chunk_text(text, max_size, overlap):
    sections = re.split(r'\n\*+\s+', text)  # Org heading
    # ... 30ì¤„ ë¡œì§
#+end_src

*2. Hybrid Search* (ELISA SQL íŒ¨í„´):

#+begin_src sql
-- Supabaseì—ì„œ ë™ì¼í•˜ê²Œ êµ¬í˜„
-- Vector + FTS + RRF
#+end_src

*3. Properties í™œìš©* (Org-roam íŒ¨í„´):

#+begin_src python
# Frontmatterë¡œ ë³€í™˜
if frontmatter.get('search') == 'ignore':
    skip()

priority = frontmatter.get('priority', 'normal')
boost = {'high': 1.5, 'normal': 1.0, 'low': 0.8}[priority]
#+end_src

*4. í´ë”ë³„ ì°¨ë³„í™”* (embedding-config ê²€ì¦):

#+begin_src python
FOLDER_CONFIG = {
    'architecture': {'chunk_size': 1500, 'overlap': 200},
    # ...
}
#+end_src

*5. SQLite or PostgreSQL* (Backend):

#+begin_src python
# Local: SQLite (ELISA íŒ¨í„´, Emacs ë‚´ì¥)
# Production: Supabase PostgreSQL (ê²€ì¦ë¨)
#+end_src

--------------

** ğŸ“ í•µì‹¬ ê¹¨ë‹¬ìŒ
:PROPERTIES:
:CUSTOM_ID: í•µì‹¬-ê¹¨ë‹¬ìŒ
:END:
*** Q: ì™œ ë³µì¡í•œ Chonkieê°€ ì¡´ì¬í•˜ë‚˜?
:PROPERTIES:
:CUSTOM_ID: q-ì™œ-ë³µì¡í•œ-chonkieê°€-ì¡´ì¬í•˜ë‚˜
:END:
*A*: ë²”ìš©ì„±ì„ ì¶”êµ¬í•˜ë‹¤ ë³´ë‹ˆ ë³µì¡í•´ì§

#+begin_example
Chonkie:
  ëª¨ë“  ë¬¸ì„œ íƒ€ì… (PDF, Code, Markdown, HTML...)
  ëª¨ë“  ì²­í‚¹ ë°©ì‹ (9ê°€ì§€)
  ëª¨ë“  ì‚¬ìš©ì (ì´ˆë³´ì ~ ì „ë¬¸ê°€)

  â†’ 33,777ì¤„
#+end_example

--------------

*** Q: Org-modeëŠ”?
:PROPERTIES:
:CUSTOM_ID: q-org-modeëŠ”
:END:
*A*: Org êµ¬ì¡°ê°€ ì´ë¯¸ ì²­í‚¹ì„ ìœ„í•´ ì„¤ê³„ë¨

#+begin_example
Org Heading:
  ,* = Level 1 (ê°œë…)
  ,** = Level 2 (ì„¸ë¶€)
  ,*** = Level 3 (êµ¬ì²´)

Paragraph:
  ë¹ˆ ì¤„ë¡œ êµ¬ë¶„ = forward-paragraph

Properties:
  :SEARCH: ignore = ì œì–´
  :ID: uuid = ì—°ê²°

Denote:
  timestamp--title__tags = ë©”íƒ€ë°ì´í„°

â†’ 30ì¤„ì´ë©´ ì¶©ë¶„
â†’ Org ì² í•™ ì¡´ì¤‘
â†’ ê°„ë‹¨í•¨ > ë³µì¡í•¨
#+end_example

--------------

*** Q: Emacs ì»¤ë®¤ë‹ˆí‹°ì˜ ì ‘ê·¼?
:PROPERTIES:
:CUSTOM_ID: q-emacs-ì»¤ë®¤ë‹ˆí‹°ì˜-ì ‘ê·¼
:END:
*A*: ì² í•™ì , ì‹¤ìš©ì , ê°„ë‹¨í•¨

#+begin_example
1. Org Structure í™œìš©
   â†’ ì¬ì„¤ê³„ ì•„ë‹Œ í™œìš©

2. Emacs ë‚´ì¥ í•¨ìˆ˜
   â†’ forward-paragraph, forward-sentence

3. SQLite ë°±ì—”ë“œ
   â†’ Emacs 29.2+ ë‚´ì¥

4. Hybrid Search
   â†’ Vector + FTS + RRF

5. ë¡œì»¬ ìš°ì„ 
   â†’ Ollama, ONNX

6. ê°„ë‹¨í•œ ì½”ë“œ
   â†’ 30ì¤„ë¡œ ì¶©ë¶„
   â†’ ì½ì„ ìˆ˜ ìˆì–´ì•¼ í•¨
   â†’ í†µì œ ê°€ëŠ¥í•´ì•¼ í•¨
#+end_example

--------------

** ğŸ¯ memex-kb v2.0 ìµœì¢… ì „ëµ
:PROPERTIES:
:CUSTOM_ID: memex-kb-v2.0-ìµœì¢…-ì „ëµ
:END:
*** Emacs ì§€í˜œ í†µí•©
:PROPERTIES:
:CUSTOM_ID: emacs-ì§€í˜œ-í†µí•©
:END:
#+begin_src python
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Conversion (v1.x)                           â”‚
â”‚ - Backend Adapter (Google Docs, Dooray...) â”‚
â”‚ - Denote íŒŒì¼ëª… ìƒì„±                        â”‚
â”‚ - ê·œì¹™ ê¸°ë°˜ ë¶„ë¥˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Embedding (v2.0) - Emacs ì§€í˜œ ì ìš©         â”‚
â”‚                                             â”‚
â”‚ 1. ì²­í‚¹ (ELISA íŒ¨í„´):                       â”‚
â”‚    - Markdown Heading ê¸°ì¤€ (#, ##, ###)    â”‚
â”‚    - 30ì¤„ ê°„ë‹¨ ë¡œì§                         â”‚
â”‚    - í´ë”ë³„ ì°¨ë³„í™” (ê²€ì¦ë¨)                 â”‚
â”‚                                             â”‚
â”‚ 2. ë©”íƒ€ë°ì´í„° (Org-roam íŒ¨í„´):              â”‚
â”‚    - Denote íŒŒì¼ëª… íŒŒì‹±                     â”‚
â”‚    - Frontmatter Properties                 â”‚
â”‚    - search: ignore ì§€ì›                    â”‚
â”‚                                             â”‚
â”‚ 3. ì„ë² ë”© (sem.el íŒ¨í„´):                    â”‚
â”‚    - Ollama ë¡œì»¬ (mxbai-embed-large)       â”‚
â”‚    - ì™„ì „ í†µì œ                              â”‚
â”‚                                             â”‚
â”‚ 4. ì €ì¥ (ekg íŒ¨í„´):                         â”‚
â”‚    - PostgreSQL (Supabase or ë¡œì»¬)         â”‚
â”‚    - ë˜ëŠ” SQLite (Emacs í†µí•©ìš©)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Search (ELISA íŒ¨í„´)                         â”‚
â”‚ - Hybrid: Vector + FTS + RRF (SQL!)        â”‚
â”‚ - Reranker (ì„ íƒì )                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Emacs Integration (semext ìŠ¤íƒ€ì¼)           â”‚
â”‚ - M-x memex-kb-search                       â”‚
â”‚ - Denote ë§í¬ ì‚½ì…                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#+end_src

--------------

** ğŸŒŸ ì°¨ë³„í™” í¬ì¸íŠ¸
:PROPERTIES:
:CUSTOM_ID: ì°¨ë³„í™”-í¬ì¸íŠ¸
:END:
*** memex-kb = "Emacs ì² í•™ + ë²”ìš©ì„±"
:PROPERTIES:
:CUSTOM_ID: memex-kb-emacs-ì² í•™-ë²”ìš©ì„±
:END:
*Emacs í”„ë¡œì íŠ¸ë“¤*:

#+begin_example
ELISA: Emacs ì „ìš© (Info, local files)
Org-roam: Org-roam ì „ìš©
sem.el: Emacs symbols
ekg: SQLite ê¸°ë°˜

â†’ Emacs ë‚´ë¶€ìš©
#+end_example

*memex-kb*:

#+begin_example
ë³€í™˜: Google Docs, Dooray, Confluence...
  â†“ Denote Markdown (Org ì² í•™ ì ìš©!)
ì„ë² ë”©: Emacs ì»¤ë®¤ë‹ˆí‹° ì „ëµ (30ì¤„ ì²­í‚¹)
  â†“ Vector DB
ê²€ìƒ‰: ELISA Hybrid Search íŒ¨í„´
  â†“ Emacs/n8n/API

â†’ Legacy â†’ Emacs ì² í•™ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ì…êµ¬!
#+end_example

*ë…ì°½ì„±*:

#+begin_example
1. Emacs ì™¸ë¶€ ì†ŒìŠ¤ (Google Docs, Dooray...)
2. Emacs ì² í•™ ì ìš© (Denote, ê°„ë‹¨ ì²­í‚¹)
3. Emacs í†µí•© ê°€ëŠ¥ (semext ìŠ¤íƒ€ì¼)
4. ë²”ìš© í”Œë«í¼ ê°€ëŠ¥ (n8n, API)

â†’ "Emacs ì•ˆíŒì„ ì—°ê²°í•˜ëŠ” ë‹¤ë¦¬"
#+end_example

--------------

** ğŸ”— ì°¸ê³  í”„ë¡œì íŠ¸
:PROPERTIES:
:CUSTOM_ID: ì°¸ê³ -í”„ë¡œì íŠ¸
:END:
*Emacs RAG*: - ELISA: https://github.com/s-kostyaev/elisa (~30ì¤„ ì²­í‚¹,
SQLite, Hybrid Search) - sem.el:
https://lepisma.xyz/2025/01/17/emacs-on-device-ml/ (ONNX, ë¡œì»¬) - ekg:
https://github.com/ahyatt/ekg (Knowledge Graph, SQLite) - semext:
https://github.com/ahyatt/semext (Semantic Emacs)

*Org íŠ¹í™”*: - Org-roam semantic:
https://lgmoneda.github.io/2023/04/08/semantic-search-for-org-roam.html
(3.4k notes) - ekg-denote: ekg + Denote í†µí•© (ê°œë°œ ì¤‘)

*ì°¸ê³ *: - ahyatt (Andrew Hyatt): ekg, semext, llm, triples ê°œë°œì -
Protesilaos Stavrou: Denote ê°œë°œì

--------------

** ğŸ’¡ ê²°ë¡ : "Org-mode ì² í•™ì„ ë”°ë¥´ë¼"
:PROPERTIES:
:CUSTOM_ID: ê²°ë¡ -org-mode-ì² í•™ì„-ë”°ë¥´ë¼
:END:
*** Emacs ì»¤ë®¤ë‹ˆí‹°ì˜ ì§€í˜œ
:PROPERTIES:
:CUSTOM_ID: emacs-ì»¤ë®¤ë‹ˆí‹°ì˜-ì§€í˜œ
:END:
#+begin_example
1. ê°„ë‹¨í•¨ > ë³µì¡í•¨
   - 30ì¤„ ì²­í‚¹ > 379ì¤„ ë¼ì´ë¸ŒëŸ¬ë¦¬

2. Org êµ¬ì¡° í™œìš© > ì¬ë°œëª…
   - Heading, Paragraph, Properties

3. í†µì œê¶Œ > í¸ë¦¬í•¨
   - ì§ì ‘ ì‘ì„± > ë¸”ë™ë°•ìŠ¤

4. ë¡œì»¬ ìš°ì„  > í´ë¼ìš°ë“œ
   - Ollama, ONNX > API

5. SQLite/PostgreSQL > íŒŒì¼
   - ê²€ìƒ‰ ìµœì í™”

6. Hybrid Search > Vectorë§Œ
   - Vector + FTS + RRF
#+end_example

--------------

*** memex-kbì˜ í¬ì§€ì…˜
:PROPERTIES:
:CUSTOM_ID: memex-kbì˜-í¬ì§€ì…˜
:END:
#+begin_example
"Emacs ì² í•™ì„ Legacy ì„¸ê³„ì— ì „íŒŒí•œë‹¤"

Legacy ë¬¸ì„œ (ë³µì¡, ë¶ˆì¼ì¹˜)
    â†“ memex-kb (Denote ê·œì¹™)
Org ì² í•™ (ê°„ë‹¨, ì¼ê´€)
    â†“ Emacs ì»¤ë®¤ë‹ˆí‹° ì „ëµ
RAG-ready (í’ˆì§ˆ, í†µì œ)
#+end_example

*ê°€ì¹˜*:

#+begin_example
Chonkie: ë²”ìš© RAG (ë³µì¡)
ELISA: Emacs ë‚´ë¶€ìš© (ê°„ë‹¨)
memex-kb: ë‘˜ì„ ì—°ê²° (Emacs ì² í•™ + ë²”ìš©ì„±)

â†’ ë…ì°½ì  í¬ì§€ì…”ë‹!
#+end_example

--------------

--------------

** ğŸŒ í•œê¸€ í™˜ê²½ íŠ¹í™” ì „ëµ
:PROPERTIES:
:CUSTOM_ID: í•œê¸€-í™˜ê²½-íŠ¹í™”-ì „ëµ
:END:
*** ì „ë¬¸ê°€ ë°©ì‹ì˜ í•œê¸€ ì ìš© ë¬¸ì œì 
:PROPERTIES:
:CUSTOM_ID: ì „ë¬¸ê°€-ë°©ì‹ì˜-í•œê¸€-ì ìš©-ë¬¸ì œì 
:END:
*ELISA/John Kitchin/Org-roam (ì˜ì–´ í™˜ê²½)*:

#+begin_src org
,* Machine Learning Concepts      â† ì˜ì–´ í—¤ë”©
  :PROPERTIES:
  :FILETAGS: :ml:ai:deeplearning: â† ì˜ì–´ íƒœê·¸
  :END:

íŒŒì¼ëª…: 20250101T120000.org          â† timestampë§Œ
íƒœê·¸: :ml:ai:                        â† ì˜ì–´ë§Œ
#+end_src

*embedding-config/Denote (í•œê¸€ í™˜ê²½)*:

#+begin_src org
,* ë¨¸ì‹ ëŸ¬ë‹ ê°œë… ì •ë¦¬                 â† í•œê¸€ í—¤ë”©!
  :PROPERTIES:
  :FILETAGS: :ml:ai:ë¨¸ì‹ ëŸ¬ë‹:ê°œë…:   â† í•œê¸€/ì˜ì–´ í˜¼ì¬!
  :END:

íŒŒì¼ëª…: 20250101T120000--ë¨¸ì‹ ëŸ¬ë‹-ê°œë…-ì •ë¦¬__ml_ai_machinelearning.org
        â””â”€â”€â”€â”€timestampâ”€â”€â”€â”€â”˜ â””â”€â”€í•œê¸€ ì œëª©â”€â”€â”˜ â””â”€â”€â”€â”€ì˜ì–´ íƒœê·¸â”€â”€â”€â”€â”˜
              â†‘                  â†‘                 â†‘
          Denote ID          ì¸ê°„ ì¹œí™”ì         ê²€ìƒ‰ìš©
#+end_src

--------------

*** í•œê¸€ í™˜ê²½ ê³ ìœ  ì´ìŠˆ
:PROPERTIES:
:CUSTOM_ID: í•œê¸€-í™˜ê²½-ê³ ìœ -ì´ìŠˆ
:END:
*1. í† í° ê³„ì‚°*:

#+begin_src python
# ì˜ì–´ (John Kitchin/ELISA)
"machine learning" = 2 tokens
chars_per_token = 4-5 (í‰ê· )

# í•œê¸€ (embedding-config ê²€ì¦)
"ë¨¸ì‹ ëŸ¬ë‹" = 2 tokens
chars_per_token = 1.5-2 (í•œê¸€ì€ ë” ì¡°ë°€!)

â†’ ë™ì¼ chunk_sizeë¼ë„ í•œê¸€ì´ ë” ë§ì€ ì •ë³´ í¬í•¨
â†’ í•œê¸€ íŠ¹í™” ì¡°ì • í•„ìš”
#+end_src

*2. Denote íŒŒì¼ëª… íŒŒì‹±*:

#+begin_src python
# ì˜ì–´ ì „ë¬¸ê°€ë“¤ (Denote ë¯¸ì§€ì›)
filename: "20250101T120000.org"
â†’ timestampë§Œ ì¶”ì¶œ

# Denote (í•œê¸€ ì œëª©!)
filename: "20250101T120000--ë¨¸ì‹ ëŸ¬ë‹-ê°œë…__ml_ai.org"

íŒŒì‹± í•„ìš”:
  - timestamp: 20250101T120000
  - korean_title: "ë¨¸ì‹ ëŸ¬ë‹-ê°œë…"
  - english_tags: ["ml", "ai"]

â†’ embedding-configì— ì´ë¯¸ êµ¬í˜„ë¨!
#+end_src

*3. FILETAGS í˜¼ì¬*:

#+begin_src org
,#+filetags: :emacs:org:ì´ë§¥ìŠ¤:ì¡°ì§ëª¨ë“œ:

ì˜ì–´: emacs, org
í•œê¸€: ì´ë§¥ìŠ¤, ì¡°ì§ëª¨ë“œ

â†’ ë‘˜ ë‹¤ ì„ë² ë”©ì— í¬í•¨í•´ì•¼ ê²€ìƒ‰ í’ˆì§ˆ í–¥ìƒ
#+end_src

*4. Heading í•œê¸€/ì˜ì–´ í˜¼ì¬*:

#+begin_src org
,* Emacs ì„¤ì • ê°€ì´ë“œ           â† í˜¼ì¬
,** org-mode ì»¤ìŠ¤í„°ë§ˆì´ì§•      â† í˜¼ì¬
,*** í•œê¸€ í°íŠ¸ ì„¤ì •            â† í•œê¸€
,**** Font Configuration       â† ì˜ì–´

â†’ ëª¨ë“  ë ˆë²¨ì—ì„œ í˜¼ì¬ ê°€ëŠ¥
â†’ ì •ê·œì‹ì€ ë™ì¼í•˜ê²Œ ì‘ë™ (ë¬¸ì œ ì—†ìŒ)
â†’ í•˜ì§€ë§Œ ì„ë² ë”© ëª¨ë¸ì€ í•œê¸€ ì§€ì› í•„ìˆ˜!
#+end_src

--------------

*** í•œê¸€ íŠ¹í™” í•´ê²°ì±…
:PROPERTIES:
:CUSTOM_ID: í•œê¸€-íŠ¹í™”-í•´ê²°ì±…
:END:
*1. ì„ë² ë”© ëª¨ë¸ ì„ íƒ* (ì¤‘ìš”!):

#+begin_src yaml
ì˜ì–´ ëª¨ë¸ (John Kitchin ê¸°ë³¸):
  all-MiniLM-L6-v2:
    dimension: 384
    í•œê¸€ ì§€ì›: â­â­ (ì œí•œì )

í•œê¸€ ìµœì í™” (embedding-config ê²€ì¦):
  multilingual-e5-large:
    dimension: 1024
    í•œê¸€ ì§€ì›: â­â­â­â­
    ê²€ì¦: 2,945ê°œ Org íŒŒì¼ ì„±ê³µ

  mxbai-embed-large:
    dimension: 1024
    í•œê¸€ ì§€ì›: â­â­â­â­â­
    ì†ë„: multilingual-e5ë³´ë‹¤ ë¹ ë¦„

â†’ John Kitchin ì „ëµì— í•œê¸€ ëª¨ë¸ë§Œ êµì²´!
#+end_src

*2. Denote íŒŒì‹±* (embedding-config ì¬ì‚¬ìš©):

#+begin_src python
# embedding-configì—ì„œ ê²€ì¦ë¨ (process_org_garden.py)

def parse_denote_filename(filepath):
    """
    20250101T120000--ë¨¸ì‹ ëŸ¬ë‹-ê°œë…__ml_ai.org
    """
    pattern = r'(\d{8}T\d{6})--(.+?)__(.+?)\.org'
    match = re.match(pattern, filename)

    identifier = match.group(1)    # 20250101T120000
    korean_title = match.group(2)  # ë¨¸ì‹ ëŸ¬ë‹-ê°œë…
    english_tags = match.group(3).split('_')  # ['ml', 'ai']

    return {
        'identifier': identifier,
        'korean_title': korean_title,
        'denote_tags': english_tags
    }

â†’ ì´ë¯¸ ì™„ë²½í•˜ê²Œ êµ¬í˜„ë¨!
â†’ ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš©!
#+end_src

*3. í•œê¸€/ì˜ì–´ íƒœê·¸ í†µí•©*:

#+begin_src python
# FILETAGS íŒŒì‹±
def parse_filetags(content):
    """
    ,#+filetags: :emacs:org:ì´ë§¥ìŠ¤:ì¡°ì§ëª¨ë“œ:
    """
    pattern = r'#\+filetags:\s*:(.+?):'
    match = re.search(pattern, content, re.IGNORECASE)

    if match:
        all_tags = match.group(1).split(':')
        korean_tags = [t for t in all_tags if re.search(r'[ê°€-í£]', t)]
        english_tags = [t for t in all_tags if re.match(r'^[a-zA-Z]+$', t)]

        return {
            'korean_tags': korean_tags,      # ['ì´ë§¥ìŠ¤', 'ì¡°ì§ëª¨ë“œ']
            'english_tags': english_tags,    # ['emacs', 'org']
            'all_tags': all_tags
        }

# ì„ë² ë”© í…ìŠ¤íŠ¸ ìƒì„± (John Kitchin íŒ¨í„´ + í•œê¸€)
def prepare_heading_embedding(heading_text, denote_meta, filetags):
    """
    John Kitchin: heading + :tag1:tag2:
    í•œê¸€ íŠ¹í™”: heading + denote_tags + filetags (í•œê¸€+ì˜ì–´)
    """
    parts = [heading_text]

    # Denote íƒœê·¸ (ì˜ì–´)
    if denote_meta['denote_tags']:
        parts.append(' '.join(denote_meta['denote_tags']))

    # FILETAGS (í•œê¸€+ì˜ì–´)
    if filetags['all_tags']:
        parts.append(' '.join(filetags['all_tags']))

    return ' '.join(parts)

# ì˜ˆì‹œ
heading_text = "ë¨¸ì‹ ëŸ¬ë‹ ê°œë… ì •ë¦¬"
denote_tags = ["ml", "ai"]
filetags = ["emacs", "org", "ì´ë§¥ìŠ¤", "ì¡°ì§ëª¨ë“œ"]

result = "ë¨¸ì‹ ëŸ¬ë‹ ê°œë… ì •ë¦¬ ml ai emacs org ì´ë§¥ìŠ¤ ì¡°ì§ëª¨ë“œ"

â†’ í•œê¸€ ì„ë² ë”© ëª¨ë¸ì´ ëª¨ë‘ ì´í•´!
#+end_src

*4. í•œê¸€ í† í° ê³„ì‚°*:

#+begin_src python
# embedding-config ê²€ì¦ëœ ë°©ì‹

def calculate_korean_tokens(text):
    """
    í•œê¸€: 3ì = 1í† í°
    ì˜ì–´: 4ì = 1í† í°
    """
    korean_chars = len(re.findall(r'[ê°€-í£]', text))
    english_chars = len(re.findall(r'[a-zA-Z]', text))
    other_chars = len(text) - korean_chars - english_chars

    tokens = (korean_chars / 3) + (english_chars / 4) + (other_chars / 3)
    return int(tokens)

# John Kitchin ë°©ì‹ ê°œì„ 
def chunk_text_korean(text, chunk_size=800, overlap=100):
    """
    Position ê¸°ë°˜ (John Kitchin)
    + í•œê¸€ í† í° ê³„ì‚° (embedding-config)
    """
    chunks = []
    start = 0

    while start < len(text):
        # í•œê¸€ í† í° ê¸°ì¤€ìœ¼ë¡œ end ê³„ì‚°
        current_tokens = 0
        end = start

        while end < len(text) and current_tokens < chunk_size:
            char = text[end]
            if re.match(r'[ê°€-í£]', char):
                current_tokens += 1/3  # 3ì = 1í† í°
            elif re.match(r'[a-zA-Z]', char):
                current_tokens += 1/4  # 4ì = 1í† í°
            else:
                current_tokens += 1/3
            end += 1

        chunk = text[start:end]
        line_number = text[:start].count('\n') + 1

        chunks.append((chunk, line_number))
        start = max(start + 1, end - overlap)

    return chunks

â†’ John Kitchin ê°„ë‹¨í•¨ + embedding-config í•œê¸€ ê³„ì‚°
#+end_src

--------------

*** Pattern 2: ê°„ë‹¨í•œ ì²­í‚¹ ë¡œì§ (30-66ì¤„)
:PROPERTIES:
:CUSTOM_ID: pattern-2-ê°„ë‹¨í•œ-ì²­í‚¹-ë¡œì§-30-66ì¤„-1
:END:

--------------

** ğŸš€ ~/org/ ì‹¤í—˜ ê³„íš: "ì „ë¬¸ê°€ ë”°ë¼í•˜ê¸° + í•œê¸€ íŠ¹í™”"
:PROPERTIES:
:CUSTOM_ID: org-ì‹¤í—˜-ê³„íš-ì „ë¬¸ê°€-ë”°ë¼í•˜ê¸°-í•œê¸€-íŠ¹í™”
:END:
*** Phase 1: John Kitchin íŒ¨í„´ (1ì£¼) â­â­â­â­â­
:PROPERTIES:
:CUSTOM_ID: phase-1-john-kitchin-íŒ¨í„´-1ì£¼
:END:
*ëª©í‘œ*: Org Heading ë³„ë„ í…Œì´ë¸” + 2-Tier ê²€ìƒ‰

*ì„ íƒ ì´ìœ *:

#+begin_example
âœ… ê°„ë‹¨í•¨: 66ì¤„ ì²­í‚¹ + 80ì¤„ í—¤ë”© íŒŒì‹±
âœ… ì‹¤ìš©ì : 2-Tier ê²€ìƒ‰ (ë¹ ë¦„ + ì •í™•)
âœ… ê²€ì¦ë¨: YouTube ì‹œì—°
âœ… gptel í†µí•©: Claude Code ì—ì´ì „íŠ¸
âœ… í•œê¸€ í˜¸í™˜: ì •ê·œì‹ì€ í•œê¸€ ë¬¸ì œ ì—†ìŒ
#+end_example

*í•œê¸€ ìˆ˜ì •ì‚¬í•­*:

#+begin_src python
# 1. ì„ë² ë”© ëª¨ë¸ êµì²´
all-MiniLM-L6-v2 (384-dim, ì˜ì–´)
    â†“
mxbai-embed-large (1024-dim, í•œê¸€ ìµœì í™”)

# 2. Denote íŒŒì‹± ì¶”ê°€ (embedding-config ì¬ì‚¬ìš©)
def parse_denote_filename(filepath): ...

# 3. FILETAGS í•œê¸€/ì˜ì–´ í†µí•©
def parse_filetags(content): ...
def prepare_heading_embedding(heading, denote, filetags): ...

# 4. í•œê¸€ í† í° ê³„ì‚° (ì„ íƒì )
# ì¼ë‹¨ John Kitchin position ê¸°ë°˜ ê·¸ëŒ€ë¡œ ì‚¬ìš©
# í•„ìš” ì‹œ embedding-config í•œê¸€ ê³„ì‚° ì¶”ê°€
#+end_src

*ì‹¤í—˜ ì²´í¬ë¦¬ìŠ¤íŠ¸*:

#+begin_src sh
Day 1-2: ì„¤ì¹˜ & ì„¤ì •
  - [ ] emacs-rag-libsql ì„¤ì¹˜ (uv sync)
  - [ ] í•œê¸€ ëª¨ë¸ êµì²´ (mxbai-embed-large)
  - [ ] Emacs ì„¤ì • (~/.doom.d/config.el)

Day 3-4: ì†Œê·œëª¨ í…ŒìŠ¤íŠ¸
  - [ ] ~/org/notes/ 100ê°œ íŒŒì¼ ì¸ë±ì‹±
  - [ ] Heading ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
  - [ ] í•œê¸€ ì¿¼ë¦¬ í…ŒìŠ¤íŠ¸:
    - "ë¨¸ì‹ ëŸ¬ë‹" vs "machine learning"
    - "ì´ë§¥ìŠ¤" vs "emacs"
    - í˜¼ì¬: "Emacs ì„¤ì •"

Day 5-7: ê²€ì¦ & í•œê¸€ ì´ìŠˆ íŒŒì•…
  - [ ] í•œê¸€ ê²€ìƒ‰ í’ˆì§ˆ ì¸¡ì •
  - [ ] Denote íŒŒì‹± í•„ìš”ì„± í™•ì¸
  - [ ] FILETAGS í˜¼ì¬ ë¬¸ì œ í™•ì¸
  - [ ] gptel í†µí•© í…ŒìŠ¤íŠ¸
#+end_src

--------------

*** Phase 2: embedding-config í†µí•© (1ì£¼)
:PROPERTIES:
:CUSTOM_ID: phase-2-embedding-config-í†µí•©-1ì£¼
:END:
*ëª©í‘œ*: í´ë”ë³„ ì°¨ë³„í™” + ì§€ì‹ ê³„ì¸µ

*í†µí•© ì½”ë“œ*:

#+begin_src python
# John Kitchin ê¸°ë³¸ êµ¬ì¡°
org_headings í…Œì´ë¸”
documents í…Œì´ë¸”

# embedding-config í´ë”ë³„ ì„¤ì • ì¶”ê°€
FOLDER_CONFIG = {
    'meta': {'chunk_size': 1500, 'overlap': 200},
    'bib': {'chunk_size': 1200, 'overlap': 150},
    'journal': {'chunk_size': 800, 'overlap': 100},
    'notes': {'chunk_size': 1000, 'overlap': 150}
}

# emacs-rag-server ìˆ˜ì •
def index_file(path, content):
    folder = get_folder_from_path(path)  # ~/org/meta/ â†’ "meta"
    config = FOLDER_CONFIG.get(folder, DEFAULT)

    # í´ë”ë³„ ì²­í‚¹
    chunks = chunk_text(content,
                        chunk_size=config['chunk_size'],
                        overlap=config['overlap'])
#+end_src

*ì‹¤í—˜*:

#+begin_src sh
Day 1-3: í´ë”ë³„ ì¸ë±ì‹±
  - [ ] ~/org/meta/ (530ê°œ)
  - [ ] ~/org/bib/ (646ê°œ)
  - [ ] ~/org/journal/ (691ê°œ)
  - [ ] ~/org/notes/ (770ê°œ)

Day 4-5: ì²­í¬ í¬ê¸° ê²€ì¦
  - [ ] SELECT folder, AVG(chunk_size) FROM documents GROUP BY folder
  - [ ] meta ì²­í¬ê°€ ë” í°ì§€ í™•ì¸
  - [ ] ê²€ìƒ‰ í’ˆì§ˆ í´ë”ë³„ ë¹„êµ

Day 6-7: ì„±ëŠ¥ ì¸¡ì •
  - [ ] MRR@10, Recall@5, Recall@10
  - [ ] embedding-config ê²°ê³¼ì™€ ë¹„êµ (MRR 0.85)
#+end_src

--------------

*** Phase 3: ELISA Hybrid Search (1ì£¼)
:PROPERTIES:
:CUSTOM_ID: phase-3-elisa-hybrid-search-1ì£¼
:END:
*ëª©í‘œ*: Vector + FTS + RRF

*LibSQL SQL êµ¬í˜„* (ELISA íŒ¨í„´):

#+begin_src sql
-- ELISA RRF íŒ¨í„´ì„ LibSQLì— ì ìš©

WITH
vector_search AS (
  SELECT id, vector_distance_cosine(vector, ?) as distance,
         ROW_NUMBER() OVER (ORDER BY distance) as rank
  FROM embeddings
  ORDER BY distance LIMIT 50
),
fts_search AS (
  SELECT id, bm25(documents_fts) as score,
         ROW_NUMBER() OVER (ORDER BY score DESC) as rank
  FROM documents_fts
  WHERE MATCH ?
  LIMIT 50
),
heading_search AS (
  SELECT heading_id as id, vector_distance_cosine(vector, ?) as distance,
         ROW_NUMBER() OVER (ORDER BY distance) as rank
  FROM org_heading_embeddings
  LIMIT 50
),
rrf_combined AS (
  SELECT
    COALESCE(v.id, f.id, h.id) AS id,
    (COALESCE(1.0/(60 + v.rank), 0.0) +
     COALESCE(1.0/(60 + f.rank), 0.0) +
     COALESCE(1.0/(60 + h.rank), 0.0)) AS score
  FROM vector_search v
  FULL OUTER JOIN fts_search f USING (id)
  FULL OUTER JOIN heading_search h USING (id)
  ORDER BY score DESC
  LIMIT 20
)
SELECT * FROM rrf_combined;
#+end_src

*ì‹¤í—˜*:

#+begin_src sh
Day 1-3: RRF SQL í•¨ìˆ˜ ì‘ì„±
  - [ ] emacs-rag-server ìˆ˜ì •
  - [ ] /search/hybrid ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
  - [ ] RRF ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„

Day 4-5: í’ˆì§ˆ ë¹„êµ
  - [ ] Vector only vs Hybrid ë¹„êµ
  - [ ] MRR í–¥ìƒë„ ì¸¡ì •
  - [ ] í•œê¸€ ì¿¼ë¦¬ ì •í™•ë„

Day 6-7: gptel í†µí•©
  - [ ] rag_search_hybrid ë„êµ¬ ì¶”ê°€
  - [ ] Claude Code ì—ì´ì „íŠ¸ í…ŒìŠ¤íŠ¸
#+end_src

--------------

** ğŸ¯ í†µí•© ì „ëµ: "ì„¸ ê°€ì§€ ì§€í˜œ + í•œê¸€ íŠ¹í™”"
:PROPERTIES:
:CUSTOM_ID: í†µí•©-ì „ëµ-ì„¸-ê°€ì§€-ì§€í˜œ-í•œê¸€-íŠ¹í™”
:END:
*** ìµœì¢… ì„¤ê³„
:PROPERTIES:
:CUSTOM_ID: ìµœì¢…-ì„¤ê³„
:END:
#+begin_src yaml
ê¸°ë³¸ í”„ë ˆì„ì›Œí¬: John Kitchin (emacs-rag-libsql)
  ì²­í‚¹: 66ì¤„ position ê¸°ë°˜
  êµ¬ì¡°: Org Heading ë³„ë„ í…Œì´ë¸”
  ê²€ìƒ‰: 2-Tier (í—¤ë”© â†’ ë‚´ìš©)
  í†µí•©: gptel ë„êµ¬

í•œê¸€ íŠ¹í™”: embedding-config (ê²€ì¦ë¨)
  ëª¨ë¸: mxbai-embed-large (1024-dim)
  íŒŒì‹±: Denote í•œê¸€ ì œëª© + ì˜ì–´ íƒœê·¸
  íƒœê·¸: FILETAGS í•œê¸€/ì˜ì–´ í†µí•©
  í† í°: í•œê¸€ 3ì = 1í† í°

í´ë”ë³„ ì°¨ë³„í™”: embedding-config (ê²€ì¦ë¨)
  meta: 1500 í† í° (ê°œë… ì „ì²´ ë§¥ë½)
  bib: 1200 í† í° (ì¸ìš© í¬í•¨)
  journal: 800 í† í° (ì¼ì¼ ë‹¨ìœ„)
  notes: 1000 í† í° (ê· í˜•)

Hybrid Search: ELISA (ê²€ì¦ë¨)
  Vector + FTS + RRF (SQLë¡œ!)
  SQLite or PostgreSQL

ì—ì´ì „íŠ¸: John Kitchin (ê²€ì¦ë¨)
  gptel ë„êµ¬ (rag_search, rag_search_headings)
  transient menu
  Ivy ë™ì  ê²€ìƒ‰
#+end_src

--------------

** ğŸ“‹ 3ì£¼ ì‹¤í—˜ íƒ€ì„ë¼ì¸
:PROPERTIES:
:CUSTOM_ID: ì£¼-ì‹¤í—˜-íƒ€ì„ë¼ì¸
:END:
*** Week 1: John Kitchin ê¸°ë³¸ (~/org/notes/ ì†Œê·œëª¨)
:PROPERTIES:
:CUSTOM_ID: week-1-john-kitchin-ê¸°ë³¸-orgnotes-ì†Œê·œëª¨
:END:
#+begin_example
Mon-Tue: emacs-rag-libsql ì„¤ì¹˜, í•œê¸€ ëª¨ë¸ êµì²´
Wed-Thu: 100ê°œ íŒŒì¼ ì¸ë±ì‹±, ê²€ìƒ‰ í…ŒìŠ¤íŠ¸
Fri-Sun: í•œê¸€ ì´ìŠˆ íŒŒì•…, ê°œì„  í•„ìš”ì‚¬í•­ ì •ë¦¬

ëª©í‘œ: John Kitchin ì „ëµ ì´í•´ + í•œê¸€ ë¬¸ì œì  ë°œê²¬
#+end_example

*** Week 2: í•œê¸€ íŠ¹í™” (~/org/ ì „ì²´)
:PROPERTIES:
:CUSTOM_ID: week-2-í•œê¸€-íŠ¹í™”-org-ì „ì²´
:END:
#+begin_example
Mon-Tue: Denote íŒŒì‹± ì¶”ê°€ (embedding-config ì¬ì‚¬ìš©)
Wed: FILETAGS í•œê¸€/ì˜ì–´ í†µí•©
Thu-Fri: í´ë”ë³„ ì°¨ë³„í™” ì²­í‚¹ ì ìš©
Sat-Sun: 2,945ê°œ íŒŒì¼ ì „ì²´ ì¸ë±ì‹± + ê²€ì¦

ëª©í‘œ: embedding-config ê²½í—˜ í†µí•© + ì „ì²´ ì¸ë±ì‹± ì™„ë£Œ
#+end_example

*** Week 3: Hybrid Search (ELISA íŒ¨í„´)
:PROPERTIES:
:CUSTOM_ID: week-3-hybrid-search-elisa-íŒ¨í„´
:END:
#+begin_example
Mon-Tue: RRF SQL í•¨ìˆ˜ ì‘ì„±
Wed-Thu: Vector/FTS/Hybrid í’ˆì§ˆ ë¹„êµ
Fri: gptel ë„êµ¬ í†µí•© (Claude Code)
Sat-Sun: ë¬¸ì„œí™” + memex-kb ì—­ì ìš© ê³„íš

ëª©í‘œ: Hybrid Search ì™„ì„± + ê²½í—˜ ë¬¸ì„œí™”
#+end_example

--------------

** ğŸ”„ memex-kb ì—­ì ìš© ê³„íš (3ì£¼ í›„)
:PROPERTIES:
:CUSTOM_ID: memex-kb-ì—­ì ìš©-ê³„íš-3ì£¼-í›„
:END:
*** "Org-mode ê²½í—˜ â†’ Denote Markdown"
:PROPERTIES:
:CUSTOM_ID: org-mode-ê²½í—˜-denote-markdown
:END:
#+begin_src yaml
3ì£¼ ì‹¤í—˜ ì™„ë£Œ í›„:
  âœ… John Kitchin íŒ¨í„´ ê²€ì¦ (í•œê¸€ í™˜ê²½)
  âœ… Heading ë³„ë„ í…Œì´ë¸” íš¨ê³¼ í™•ì¸
  âœ… 2-Tier ê²€ìƒ‰ ì†ë„ ì¸¡ì •
  âœ… í•œê¸€ íŠ¹í™” ì „ëµ í™•ë¦½
  âœ… embedding-config í†µí•© ê²€ì¦
  âœ… Hybrid Search í’ˆì§ˆ ì¸¡ì •

memex-kb v2.0 ì—­ì ìš©:
  1. Org ì²­í‚¹ â†’ Markdown ì²­í‚¹ (# í—¤ë”©)
  2. org_headings â†’ memex_headings (Markdownìš©)
  3. í•œê¸€ íŠ¹í™” ë¡œì§ í†µí•©
  4. Denote Markdown íŒŒì‹±
  5. gptel ë„êµ¬ íŒ¨í„´
  6. ê²€ì¦ëœ í´ë”ë³„ ì„¤ì •

ê°€ì¹˜:
  Org-mode: ~/org/ (ì‹¤ì „ ê²€ì¦ ì™„ë£Œ)
  Markdown: memex-kb (Legacy ë³€í™˜, ë™ì¼ ì „ëµ)

  â†’ ë‘ ë°©í–¥ ëª¨ë‘ ì§€ì›!
  â†’ Org ê²½í—˜ì´ memex-kb í’ˆì§ˆ ë³´ì¥!
#+end_src

--------------

** ğŸ”— ê´€ë ¨ ë¬¸ì„œ & ë¦¬ì†ŒìŠ¤
:PROPERTIES:
:CUSTOM_ID: ê´€ë ¨-ë¬¸ì„œ-ë¦¬ì†ŒìŠ¤
:END:
*Claude-memory (ë¦¬ì†ŒìŠ¤)*: -
~/claude-memory/resources/20251009T130000--org-í—¤ë”©-ì‹œë§¨í‹±-ê²€ìƒ‰-claude-ì—ì´ì „íŠ¸-í†µí•©-ê°€ì´ë“œ__solution_claude_agent_org_heading.md -
~/claude-memory/resources/20251009T122000--khoj-vs-emacs-rag-libsql-ì—ì´ì „íŠ¸-í™œìš©-ë¹„êµë¶„ì„__analysis_claude_agent_rag.md

*embedding-config (ê²€ì¦ëœ ê²½í—˜)*: -
~/repos/gh/embedding-config/org_embedding/ - process_org_garden.py
(539ì¤„, 2,945ê°œ ì„±ê³µ) - ORG_GARDEN_EMBEDDING_STRATEGY.md (í´ë”ë³„ ì²­í‚¹) -
ORG_GARDEN_EMBEDDING_RESULT.md (8,310 ì²­í¬) - KNOWLEDGE_HIERARCHY.md
(meta â†’ bib â†’ journal â†’ notes)

*emacs-rag-libsql (John Kitchin)*: - ~/repos/3rd/emacs-rag-libsql/ -
chunking.py (66ì¤„) - database.py (854ì¤„, Heading ë³„ë„ í…Œì´ë¸”) -
readme.org, software-design.org

*ELISA (s-kostyaev)*: - ~/repos/3rd/elisa/ - elisa.el (~30ì¤„ ì²­í‚¹, RRF
SQL)

*ë¹„êµ (ì œì™¸)*: - ~/repos/3rd/chonkie/ (33,777ì¤„, ì°¸ê³ ë§Œ)

--------------

** ğŸ“ í•µì‹¬ ê²°ë¡ 
:PROPERTIES:
:CUSTOM_ID: í•µì‹¬-ê²°ë¡ 
:END:
*** "Org-mode ìš°ì„  â†’ ê²½í—˜ ê²€ì¦ â†’ memex-kb ì—­ì ìš©"
:PROPERTIES:
:CUSTOM_ID: org-mode-ìš°ì„ -ê²½í—˜-ê²€ì¦-memex-kb-ì—­ì ìš©
:END:
*1. Org-mode ë¨¼ì €*:

#+begin_example
~/org/ 1,400+ íŒŒì¼
    â†“ John Kitchin + embedding-config + ELISA
ì‹¤ì „ ê²½í—˜ (3ì£¼ ì‹¤í—˜)
    â†“ í•œê¸€ íŠ¹í™”
ë‚˜ë§Œì˜ ì „ëµ í™•ë¦½
#+end_example

*2. ì „ë¬¸ê°€ ë”°ë¼í•˜ê¸°*:

#+begin_example
âœ… John Kitchin: Heading ë³„ë„ í…Œì´ë¸”, 2-Tier ê²€ìƒ‰, gptel
âœ… embedding-config: í´ë”ë³„ ì°¨ë³„í™”, 2,945ê°œ ê²€ì¦
âœ… ELISA: Hybrid Search (RRF), SQLite
#+end_example

*3. í•œê¸€ íŠ¹í™”*:

#+begin_example
âœ… mxbai-embed-large (1024-dim)
âœ… Denote íŒŒì‹± (í•œê¸€ ì œëª© + ì˜ì–´ íƒœê·¸)
âœ… FILETAGS í•œê¸€/ì˜ì–´ í†µí•©
âœ… í•œê¸€ í† í° ê³„ì‚° (ì„ íƒì )
#+end_example

*4. memex-kb ì—­ì ìš©*:

#+begin_example
Org ê²½í—˜ ê²€ì¦ (3ì£¼)
    â†“
Markdown ë³€í™˜ (ë™ì¼ ì „ëµ)
    â†“
memex-kb v2.0 (Legacy â†’ RAG-ready)
#+end_example

--------------

*ìµœì¢… ì—…ë°ì´íŠ¸*: 2025-10-16T14:00:00+09:00 *ë‹¤ìŒ ë‹¨ê³„*: Phase 1 ì‹¤í—˜
ì‹œì‘ (emacs-rag-libsql + í•œê¸€ ëª¨ë¸)

--------------

*"Emacs ì „ë¬¸ê°€ë¥¼ ë”°ë¼í•˜ë˜, í•œê¸€ í™˜ê²½ì— ë§ê²Œ ê°œì„ í•œë‹¤"* *"~/org/ì—ì„œ
ê²½í—˜ì„ ìŒ“ê³ , memex-kbì— ì—­ì ìš©í•œë‹¤"* *"ê°„ë‹¨í•¨, í†µì œ, ê²€ì¦ - ì´ê²ƒì´
ì‹¤ìš©ì£¼ì˜ë‹¤"*
